(logs) {
    log stdout
    errors stderr
}

(tls) {
    tls {{ email }}
}

#:80 {
#    root {{ default_web_root|default('/dev/null') }}
#    tls off
#    import logs
#}

127.0.0.1:{{ caddy_port }} {
    root {{ caddy_home }}
    templates / .txt
    ext .txt .html
    tls off
    import logs
    import blog_git
}

(blog_git) {
    git {
        repo {{ blog_repo }}
        path ./blog_repo
        branch master
        key {{ bitbucket_access_key }}
        interval -1
        clone_args --depth=1 --single-branch
        pull_args --all -s recursive -X theirs
        hook {{ webhook_path }}
    }
}
